AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-23397 - Microsoft Outlook Elevation of Privilege'
URI="/autodiscover/autodiscover.xml"
METHOD='POST'
MATCH="Microsoft Outlook"
SEVERITY='P1 - CRITICAL'
CURL_OPTS="--user-agent 'Mozilla/5.0' -s --insecure -L -H 'Content-Type: text/xml'"
SECONDARY_COMMANDS=''
PAYLOAD='<?xml version="1.0" encoding="UTF-8"?>
<Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/requestschema/2006">
    <Request>
        <EMailAddress>user@example.com</EMailAddress>
        <AcceptableResponseSchema>http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a</AcceptableResponseSchema>
    </Request>
</Autodiscover>'

# This CVE allows for NTLM relay attacks via specially crafted calendar invites
# The vulnerability is in how Outlook handles reminder notifications with custom sounds from UNC paths
# The actual exploit requires a malicious SMB server to capture NTLM hashes
