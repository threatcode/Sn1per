AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-32452 - VMware vRealize Log Insight RCE'
URI="/auth/login"
METHOD='POST'
MATSEVERITY='P1 - CRITICAL'
CURL_OPTS="--user-agent 'VMware/1.0' -s --insecure -L -H 'Content-Type: application/json' -H 'X-Forwarded-For: 127.0.0.1'"
PAYLOAD='{"username":"admin","password":"test","tenantName":"test"}'
SECONDARY_COMMANDS='''
# Check for vulnerable vRealize Log Insight version
VERSION_CHECK=$(curl -s -k -I "https://$TARGET/" | grep -i '^Server:' | grep -i 'vRealize')
if [ -n "$VERSION_CHECK" ]; then
    echo -e "\n[!] vRealize Log Insight Detected"
    echo "[*] Versions before 8.10.2, 8.6.0.3, 8.8.2.1, 8.12.0 are vulnerable"
    echo "[*] This is an unauthenticated RCE vulnerability"
fi
'''

# This vulnerability allows unauthenticated attackers to execute arbitrary code on affected vRealize Log Insight instances
