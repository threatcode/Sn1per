AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-32439 - Fortinet FortiNAC Remote Code Execution'
URI="/fgtauth"
METHOD='POST'
MATCH='root:'
SEVERITY='P1 - CRITICAL'
CURL_OPTS="--user-agent 'Mozilla/5.0' -s --insecure -L -H 'Content-Type: application/x-www-form-urlencoded'"
PAYLOAD='username=admin&password=test&login=Login'
SECONDARY_COMMANDS='''
# Check for vulnerable FortiNAC version
VERSION_CHECK=$(curl -s -k -I "https://$TARGET/" | grep -i '^Server:' | grep -i 'FortiNAC')
if [ -n "$VERSION_CHECK" ]; then
    echo -e "\n[!] FortiNAC Detected"
    echo "[*] Versions before 9.4.3, 9.2.8, 9.1.9, 8.8.12, 8.7.12, 8.6.11, 8.5.11, 8.3.7 are vulnerable"
    echo "[*] This is an unauthenticated RCE vulnerability"
fi
'''

# This vulnerability allows unauthenticated attackers to execute arbitrary code on affected FortiNAC devices
