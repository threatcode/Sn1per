AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-3825 - WordPress 6.2.2 SQL Injection'
URI="/wp-json/wp/v2/posts?search='"
METHOD='GET'
MATCH='SQL syntax.*WordPress'
SEVERITY='P2 - HIGH'
CURL_OPTS="--user-agent 'Mozilla/5.0' -s -L --insecure"
SECONDARY_COMMANDS='''
# Check WordPress version
VERSION_CHECK=$(curl -s -k "$TARGET/readme.html" | grep -oP 'Version \K[0-9]+\.[0-9]+(\.[0-9]+)?' | head -1)
if [ -n "$VERSION_CHECK" ]; then
    echo -e "\n[+] WordPress Version: $VERSION_CHECK"
    echo "[*] Versions before 6.2.3 are vulnerable"
    echo "[*] This is a time-based blind SQL injection in the REST API"
fi
'''

# This vulnerability allows unauthenticated attackers to extract sensitive data from the database
