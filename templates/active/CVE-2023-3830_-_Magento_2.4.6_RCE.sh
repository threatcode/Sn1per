AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-3830 - Magento 2.4.6 RCE'
URI="/admin/admin/index/index/key/"
METHOD='GET'
MATCH='Magento.*Version 2\.4\.6'
SEVERITY='P1 - CRITICAL'
CURL_OPTS="--user-agent 'Mozilla/5.0' -s -L --insecure --cookie 'admin=1'"
SECONDARY_COMMANDS='''
# Check Magento version
VERSION_CHECK=$(curl -s -k "$TARGET/magento_version" | grep -oP 'Magento/[0-9]+\.[0-9]+\.[0-9]+' | head -1)
if [ -n "$VERSION_CHECK" ]; then
    echo -e "\n[+] $VERSION_CHECK Detected"
    echo "[*] Versions 2.4.6 and below are vulnerable"
    echo "[*] This is an authenticated RCE in the admin panel"
fi
'''

# This vulnerability allows authenticated admin users to execute arbitrary code on the server
