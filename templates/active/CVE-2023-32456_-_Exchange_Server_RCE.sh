AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-32456 - Microsoft Exchange Server RCE'
URI="/owa/auth/current/themes/resources/segoeui-1.0/fonts/"
METHOD='GET'
MATCH='Microsoft Exchange Server'
SEVERITY='P1 - CRITICAL'
CURL_OPTS="--user-agent 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36' -s --insecure -L"
SECONDARY_COMMANDS='''
# Check Exchange Server version
VERSION_CHECK=$(curl -s -k -I "https://$TARGET/owa/" | grep -i '^X-OWA-Version:' | grep -oP '\d+\.\d+\.\d+\.\d+')
if [ -n "$VERSION_CHECK" ]; then
    echo -e "\n[+] Exchange Server Version: $VERSION_CHECK"
    echo "[*] Versions before the May 2023 Security Update are vulnerable"
    echo "[*] This is a post-authentication RCE vulnerability"
fi
'''

# This vulnerability allows authenticated attackers to execute arbitrary code on affected Exchange Servers
