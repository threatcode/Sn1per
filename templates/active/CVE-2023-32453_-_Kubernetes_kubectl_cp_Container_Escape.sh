AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-32453 - Kubernetes Container Escape via kubectl cp'
URI="/api/v1/namespaces/default/pods"
METHOD='POST'
MATCH='container escape'
SEVERITY='P1 - CRITICAL'
CURL_OPTS="--user-agent 'kubectl/v1.28.0 (linux/amd64) kubernetes/4e13dda' -s --insecure -L -H 'Content-Type: application/json' -H 'Authorization: Bearer $TOKEN'"
SECONDARY_COMMANDS='''
# Check Kubernetes version
VERSION_CHECK=$(kubectl version --short 2>/dev/null | grep -oP 'Server Version: v\K[0-9]+\.[0-9]+\.[0-9]+')
if [ -n "$VERSION_CHECK" ]; then
    echo -e "\n[!] Kubernetes Version: $VERSION_CHECK"
    echo "[*] Versions before 1.25.14, 1.26.8, 1.27.5, 1.28.1 are vulnerable"
    echo "[*] This vulnerability allows container escape to the host node"
fi
'''

# This vulnerability allows attackers with pod exec/create permissions to escape container boundaries and gain root access to the host node
