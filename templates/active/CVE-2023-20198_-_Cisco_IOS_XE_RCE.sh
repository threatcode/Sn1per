AUTHOR='@xer0dayz'
VULN_NAME='CVE-2023-20198 - Cisco IOS XE Web UI Remote Code Execution'
URI="/webui/logoutconfirm.html?logon_hash=1"
METHOD='GET'
MATCH="<title>Cisco</title>"
SEVERITY='P1 - CRITICAL'
CURL_OPTS="--user-agent 'Mozilla/5.0' -s --insecure -L -H 'Accept-Encoding: gzip, deflate' -H 'Accept: */*'"
SECONDARY_COMMANDS='''
# Check for vulnerable version
VERSION_CHECK=$(curl -s -k -X POST -H "Content-Type: application/json" -d '{"jsonrpc":"2.0","method":"cli","params":{"cmd":"show version","version":"1"},"id":1}' https://$TARGET/webui/rest/api/v1/global/cli 2>/dev/null | grep -oP '(?<="version":")\d+\.\d+(\.\d+)?')
if [ -n "$VERSION_CHECK" ]; then
    echo -e "\n[+] Cisco IOS XE Version: $VERSION_CHECK"
    echo "[*] Versions 16.12.4, 17.3.6, 17.6.5, 17.9.4, and earlier are vulnerable"
fi
'''

# This vulnerability allows unauthenticated attackers to create privileged accounts and execute arbitrary code
# on affected Cisco IOS XE devices with the Web UI enabled
