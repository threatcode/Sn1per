# Container Security Configuration for Sn1per
# This configuration optimizes Sn1per for container security assessment

# General Settings
CONTAINER_RUNTIME="docker"  # Options: docker, containerd, crio, podman
SCAN_RUNNING_CONTAINERS="1"
SCAN_STOPPED_CONTAINERS="1"
SCAN_CONTAINER_IMAGES="1"
SCAN_CONTAINER_REGISTRIES="1"
SCAN_CONTAINER_ORCHESTRATORS="1"

# Docker Configuration
DOCKER_SOCKET="/var/run/docker.sock"
DOCKER_TLS_ENABLED="0"
DOCKER_TLS_VERIFY="0"
DOCKER_CERT_PATH="$HOME/.docker/"

# Kubernetes Configuration
KUBECONFIG="$HOME/.kube/config"
SCAN_KUBERNETES_CLUSTER="1"
SCAN_KUBERNETES_NAMESPACES="all"  # Comma-separated list or 'all'
SCAN_KUBERNETES_PODS="1"
SCAN_KUBERNETES_DEPLOYMENTS="1"
SCAN_KUBERNETES_SERVICES="1"
SCAN_KUBERNETES_INGRESS="1"
SCAN_KUBERNETES_NETWORK_POLICIES="1"
SCAN_KUBERNETES_RBAC="1"
SCAN_KUBERNETES_PSP="1"
SCAN_KUBERNETES_CRDS="1"

# Container Registry Configuration
REGISTRY_URL=""
REGISTRY_USERNAME=""
REGISTRY_PASSWORD=""
REGISTRY_INSECURE="0"
SCAN_REGISTRY_IMAGES="1"
SCAN_REGISTRY_TAGS="latest"  # Comma-separated list or 'all'

# Container Security Scanning Tools
USE_TRIVY="1"
TRIVY_SEVERITY="CRITICAL,HIGH,MEDIUM"
TRIVY_IGNORE_UNFIXED="1"
TRIVY_VULN_TYPE="os,library"
TRIVY_SECURITY_CHECKS="vuln,config,secret"

USE_DOCKLE="1"
DOCKLE_IGNORE_CHECKS=""
DOCKLE_ACCEPT_KEYS=""

USE_CLAIRE="1"
USE_ANCHORE="0"
USE_CLAIR="1"
USE_GRYPE="1"

# Container Vulnerability Scanning
SCAN_VULNERABILITIES="1"
SCAN_MISCONFIGURATIONS="1"
SCAN_SECRETS="1"
SCAN_DEPENDENCIES="1"
SCAN_OS_PACKAGES="1"
SCAN_LANGUAGE_PACKAGES="1"
SCAN_ROOTFS="1"

# Container Runtime Security
MONITOR_CONTAINER_RUNTIME="1"
DETECT_PRIVILEGED_CONTAINERS="1"
DETECT_ROOT_CONTAINERS="1"
DETECT_EXPOSED_DOCKER_SOCKET="1"
DETECT_SENSITIVE_MOUNTS="1"
DETECT_SENSITIVE_ENV_VARS="1"

# Container Network Security
SCAN_CONTAINER_NETWORK="1"
DETECT_EXPOSED_PORTS="1"
DETECT_NETWORK_POLICIES="1"
DETECT_NETWORK_ISOLATION="1"

# Container Storage Security
SCAN_VOLUMES="1"
DETECT_SENSITIVE_VOLUMES="1"
DETECT_READ_ONLY_FILESYSTEM="1"
DETECT_TMPFS_MOUNTS="1"

# Container Image Security
SCAN_IMAGE_HISTORY="1"
SCAN_IMAGE_LAYERS="1"
DETECT_CLEAR_TEXT_CREDENTIALS="1"
DETECT_HARDCODED_SECRETS="1"
DETECT_EXPOSED_CREDENTIALS="1"

# Container Compliance
CHECK_CIS_BENCHMARK="1"
CHECK_NIST_BENCHMARK="1"
CHECK_DISA_STIG="1"
CHECK_ISO27001="1"
CHECK_HIPAA="1"
CHECK_PCI_DSS="1"
CHECK_GDPR="1"

# Kubernetes Security
SCAN_KUBERNETES_API="1"
SCAN_KUBERNETES_ETCD="1"
SCAN_KUBERNETES_DASHBOARD="1"
SCAN_KUBERNETES_DNS="1"
SCAN_KUBERNETES_PROXY="1"
SCAN_KUBERNETES_SCHEDULER="1"
SCAN_KUBERNETES_CONTROLLER="1"
SCAN_KUBERNETES_WORKERS="1"

# Kubernetes Workload Security
SCAN_KUBERNETES_POD_SECURITY_CONTEXT="1"
SCAN_KUBERNETES_CONTAINER_SECURITY_CONTEXT="1"
SCAN_KUBERNETES_SERVICE_ACCOUNTS="1"
SCAN_KUBERNETES_NETWORK_POLICIES="1"
SCAN_KUBERNETES_INGRESS="1"
SCAN_KUBERNETES_STORAGE="1"

# Kubernetes API Security
SCAN_KUBERNETES_API_AUTHENTICATION="1"
SCAN_KUBERNETES_API_AUTHORIZATION="1"
SCAN_KUBERNETES_API_ADMISSION_CONTROLLERS="1"
SCAN_KUBERNETES_API_AUDIT_LOGGING="1"

# Kubernetes Network Security
SCAN_KUBERNETES_NETWORK_POLICIES="1"
SCAN_KUBERNETES_NETWORK_ISOLATION="1"
SCAN_KUBERNETES_NETWORK_PLUGIN="1"
SCAN_KUBERNETES_EGRESS_CONTROL="1"

# Kubernetes Storage Security
SCAN_KUBERNETES_VOLUMES="1"
SCAN_KUBERNETES_SECRETS="1"
SCAN_KUBERNETES_CONFIGMAPS="1"
SCAN_KUBERNETES_PERSISTENT_VOLUMES="1"

# Kubernetes Monitoring and Logging
SCAN_KUBERNETES_LOGGING="1"
SCAN_KUBERNETES_MONITORING="1"
SCAN_KUBERNETES_AUDIT_LOGS="1"
SCAN_KUBERNETES_EVENTS="1"

# Kubernetes Compliance
SCAN_KUBERNETES_CIS_BENCHMARK="1"
SCAN_KUBERNETES_NIST_BENCHMARK="1"
SCAN_KUBERNETES_DISA_STIG="1"
SCAN_KUBERNETES_ISO27001="1"
SCAN_KUBERNETES_HIPAA="1"
SCAN_KUBERNETES_PCI_DSS="1"
SCAN_KUBERNETES_GDPR="1"

# Container Registry Security
SCAN_REGISTRY_AUTHENTICATION="1"
SCAN_REGISTRY_AUTHORIZATION="1"
SCAN_REGISTRY_IMAGE_SIGNING="1"
SCAN_REGISTRY_IMAGE_SCANNING="1"
SCAN_REGISTRY_IMAGE_ACCESS_CONTROL="1"

# Container Build Security
SCAN_DOCKERFILE="1"
SCAN_DOCKER_COMPOSE="1"
SCAN_KUBERNETES_MANIFESTS="1"
SCAN_HELM_CHARTS="1"
SCAN_KUSTOMIZE="1"

# Container Runtime Security
MONITOR_CONTAINER_RUNTIME="1"
DETECT_CONTAINER_ESCAPE="1"
DETECT_PRIVILEGE_ESCALATION="1"
DETECT_SHELL_ACCESS="1"
DETECT_REVERSE_SHELLS="1"
DETECT_CRYPTOMINERS="1"
DETECT_MALWARE="1"

# Container Network Security
MONITOR_CONTAINER_NETWORK="1"
DETECT_NETWORK_ANOMALIES="1"
DETECT_DNS_EXFILTRATION="1"
DETECT_DNS_TUNNELING="1"
DETECT_PORT_SCANNING="1"
DETECT_BRUTE_FORCE_ATTEMPTS="1"

# Container File System Security
MONITOR_FILE_SYSTEM="1"
DETECT_FILE_CHANGES="1"
DETECT_SENSITIVE_FILES="1"
DETECT_UNAUTHORIZED_MOUNTS="1"
DETECT_UNAUTHORIZED_VOLUMES="1"

# Container Process Security
MONITOR_PROCESSES="1"
DETECT_NEW_PROCESSES="1"
DETECT_PRIVILEGED_PROCESSES="1"
DETECT_SUSPICIOUS_PROCESSES="1"
DETECT_CRYPTOMINING_PROCESSES="1"

# Container User Security
MONITOR_USERS_AND_GROUPS="1"
DETECT_NEW_USERS="1"
DETECT_PRIVILEGED_USERS="1"
DETECT_SUDO_ACCESS="1"
DETECT_SUID_SGID_FILES="1"

# Container Logging and Monitoring
ENABLE_CONTAINER_LOGGING="1"
ENABLE_CONTAINER_METRICS="1"
ENABLE_CONTAINER_TRACING="1"
ENABLE_CONTAINER_AUDITING="1"

# Container Incident Response
ENABLE_INCIDENT_RESPONSE="1"
AUTOMATED_INCIDENT_RESPONSE="1"
FORENSIC_COLLECTION="1"
CONTAINER_FORENSICS="1"
MEMORY_FORENSICS="1"

# Container Security Tools
USE_FALCO="1"
USE_AQUA="0"
USE_AQUA_ENTERPRISE="0"
USE_PRISMA_CLOUD="0"
USE_SYS_DIG="1"
USE_OSQUERY="1"
USE_CILIUM="1"
USE_CALICO="1"

# Container Security Posture Management
ENABLE_CSPM="1"
CSPM_PROVIDER=""  # Options: aws, azure, gcp, on-prem
CSPM_FRAMEWORKS="cis, nist, pci"

# Container Vulnerability Management
ENABLE_VULNERABILITY_MANAGEMENT="1"
VULNERABILITY_SCAN_SCHEDULE="0 0 * * *"  # Daily at midnight
VULNERABILITY_SCAN_THRESHOLD="high"
VULNERABILITY_SCAN_REPORT_FORMAT="html"

# Container Image Signing and Verification
ENABLE_IMAGE_SIGNING="1"
ENABLE_IMAGE_VERIFICATION="1"
SIGNING_KEY_PATH=""
VERIFICATION_KEY_PATH=""

# Container Runtime Protection
ENABLE_RUNTIME_PROTECTION="1"
RUNTIME_PROTECTION_ENGINE=""  # Options: falco, aqua, prisma, sysdig
RUNTIME_PROTECTION_RULES="$INSTALL_DIR/conf/container-rules"

# Container Network Security
ENABLE_NETWORK_POLICIES="1"
ENABLE_NETWORK_ISOLATION="1"
ENABLE_EGRESS_CONTROL="1"
ENABLE_INGRESS_CONTROL="1"

# Container Secrets Management
ENABLE_SECRETS_MANAGEMENT="1"
SECRETS_MANAGEMENT_PROVIDER=""  # Options: hashicorp-vault, aws-secrets-manager, azure-key-vault, gcp-secret-manager
SECRETS_MANAGEMENT_INTEGRATION="1"

# Container Compliance and Governance
ENABLE_COMPLIANCE_MONITORING="1"
COMPLIANCE_STANDARDS="cis, nist, pci, gdpr, hipaa"
AUTOMATED_REMEDIATION="1"

# Container Security Reporting
REPORT_FORMAT="html"  # Options: html, json, pdf, csv
REPORT_OUTPUT_DIR="$LOOT_DIR/container-security"
REPORT_RETENTION_DAYS="90"

# Container Security Notifications
ENABLE_EMAIL_NOTIFICATIONS="0"
EMAIL_RECIPIENTS=""
ENABLE_SLACK_NOTIFICATIONS="0"
SLACK_WEBHOOK_URL=""
ENABLE_WEBHOOK_NOTIFICATIONS="0"
WEBHOOK_URL=""

# Container Security API
ENABLE_API="1"
API_PORT="8080"
API_AUTHENTICATION="1"
API_AUTHENTICATION_TOKEN=""

# Container Security Advanced Options
DEBUG_MODE="0"
VERBOSE_OUTPUT="0"
ENABLE_PERFORMANCE_MONITORING="1"
ENABLE_RESOURCE_OPTIMIZATION="1"

# Container Security Customization
CUSTOM_CHECKS_ENABLED="1"
CUSTOM_CHECKS_DIR="$INSTALL_DIR/conf/container-checks"
CUSTOM_RULES_ENABLED="1"
CUSTOM_RULES_DIR="$INSTALL_DIR/conf/container-rules"

# Container Security Continuous Integration/Continuous Deployment (CI/CD)
ENABLE_CI_CD_INTEGRATION="1"
CI_CD_PROVIDER=""  # Options: jenkins, gitlab, github, bitbucket, azure-devops
CI_CD_CONFIG_FILE=""

# Container Security Orchestration
ENABLE_ORCHESTRATION="1"
ORCHESTRATION_PROVIDER=""  # Options: kubernetes, docker-swarm, nomad, mesos
ORCHESTRATION_CONFIG_FILE=""

# Container Security Machine Learning
ENABLE_ML_ANALYSIS="1"
ML_MODEL_PATH="$INSTALL_DIR/ml-models/container-security"
ML_THRESHOLD="0.8"

# Container Security Threat Intelligence
ENABLE_THREAT_INTELLIGENCE="1"
THREAT_INTELLIGENCE_FEEDS=""  # Comma-separated list of threat intelligence feed URLs
THREAT_INTELLIGENCE_UPDATE_FREQUENCY="24h"

# Container Security Automation
ENABLE_AUTOMATION="1"
AUTOMATION_PROVIDER=""  # Options: ansible, terraform, puppet, chef
AUTOMATION_PLAYBOOK_PATH=""

# Container Security Backup and Recovery
ENABLE_BACKUP="1"
BACKUP_LOCATION=""  # Local path or cloud storage URL
BACKUP_RETENTION_DAYS="30"

# Container Security Training and Awareness
ENABLE_TRAINING="1"
TRAINING_MODULES=""  # Comma-separated list of training modules
TRAINING_FREQUENCY="30d"

# Container Security Governance
ENABLE_GOVERNANCE="1"
GOVERNANCE_FRAMEWORK=""  # Options: itil, cobit, iso27001, nist-csf
GOVERNANCE_POLICIES=""  # Path to governance policies

# Container Security Continuous Improvement
ENABLE_CONTINUOUS_IMPROVEMENT="1"
IMPROVEMENT_METRICS=""  # Comma-separated list of metrics to track
IMPROVEMENT_GOALS=""  # Comma-separated list of improvement goals
